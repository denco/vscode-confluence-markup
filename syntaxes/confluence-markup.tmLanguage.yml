fileTypes:
    - confluence
    - markup
    - wiki
firstLineMatch: confluence
keyEquivalent: ^~C
name: Confluence markup
scopeName: text.html.confluence
patterns:
    - include: "#paragraph"
repository:
    paragraph:
        name: meta.paragraph.confluence
        begin: ^
        end: ^$
        patterns:
            - include: "#hr"
            - include: "#heading"
            - include: "#table"
            - include: "#inline"
    heading:
        name: markup.heading.confluence
        match: (?:^|\G)((h[1-6])\.\s+(.*?)(\s+)?\s*)$
        captures:
            "2":
                name: meta.tag.$2.confluence
            "3":
                name: text.html.heading.confluence
                patterns:
                    - include: "#inline"
    hr:
        name: markup.hr.confluence
        match: (-{4,})
        captures:
            "1":
                # name: entity.name.tag.hr.confluence
                name: meta.tag.hr.confluence
    table:
        name: markup.other.table.confluence
        begin: ^\s*(?=\|)
        end: ^(?!\s*\|)
        patterns:
            -   name: markup.other.table.header.confluence
                begin: \|\|
                beginCaptures:
                    "0":
                        name: punctuation.definition.table.header.confluence
                end: (?=\|\|?|\n)
                patterns:
                    - include: "#inline"
            -   name: markup.other.table.cell.confluence
                begin: \|(?!\|)
                beginCaptures:
                    "0":
                        name: punctuation.definition.table.cell.confluence
                end: (?=\||\n)
                patterns:
                    - include: "#inline"
    inline:
        patterns:
            - include: "#link"
            - include: "#line-break"
            - include: "#mdash"
            - include: "#ndash"
            - include: "#emoticon"
            - include: "#bold"
            - include: "#italic"
            - include: "#citation"
            - include: "#inserted"
            - include: "#superscript"
            - include: "#subscript"
            - include: "#deleted"
            - include: "#monospaced"
    link:
        name: markup.link.confluence
        match: (\[)(?:([^|\s]*?)(\|))?([^\[]*?[^\\|\s])(\])
        captures:
            "1" :
                name: meta.tag.a.begin.confluence
            "2" :
                name: text.html.link.element.confluence
            # "3" :
            #     name: punctuation.separatory.link.title.confluence
            "4" :
                name: meta.attribute.href.confluence
            "5" :
                name: meta.tag.a.end.confluence
    line-break:
        name: markup.line-break.confluence
        match: (\\\\)
        captures:
            "1" :
                name: meta.tag.br.confluence
    mdash:
        name: markup.mdash.confluence
        match: \B(-{3})\B
        captures:
            "1":
                name: text.html.mdash.element.confluence
    ndash:
        name: markup.ndash.confluence
        match: \B(-{2})\B
        captures:
            "1":
                name: text.html.ndash.element.confluence
    emoticon:
        name: markup.emoticon.confluence
        match: (\B)(:P|:D|:\)|:\(|;\)|\(y\)|\(n\)|\(i\)|\(\/\)|\(x\)|\(!\))\1
        captures:
            "2" :
                name: text.html.image.emoticon.confluence
    bold:
        name: markup.bold.confluence
        match: (\*)([^\*]*)(\1)
        captures:
            "1":
                name: meta.tag.strong.begin.confluence
            "2":
                name: text.html.bold.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.strong.end.confluence
    italic:
        name: markup.italic.confluence
        match: (\b_|\{_\})([^_]*)(_)
        captures:
            "1":
                name: meta.tag.i.begin.confluence
            "2":
                name: text.html.italic.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.i.end.confluence
    citation:
        name: markup.citation.confluence
        match: (\?{2})(.*)(\1)
        captures:
            "1":
                name: meta.tag.cite.begin.confluence
            "2":
                name: text.html.citation.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.cite.end.confluence
    inserted:
        name: markup.inserted.confluence
        match: (\+)(.*)(\1)
        captures:
            "1":
                name: meta.tag.ins.begin.confluence
            "2":
                name: text.html.inserted.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.ins.end.confluence
    superscript:
        name: markup.superscript.confluence
        match: (\^)([^\^]*)(\1)
        captures:
            "1":
                name: meta.tag.sup.begin.confluence
            "2":
                name: text.html.superscript.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.sup.end.confluence
    subscript:
        name: markup.subscript.confluence
        match: (~)([^~]*)(\1)
        captures:
            "1":
                name: meta.tag.sub.begin.confluence
            "2":
                name: text.html.subscript.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.sub.end.confluence
    deleted:
        name: markup.deleted.confluence
        match: \B(-)(.*)(\1)\B
        captures:
            "1":
                name: meta.tag.del.begin.confluence
            "2":
                name: text.html.deleted.element.confluence
                patterns:
                    - include: "#inline"
            "3":
                name: meta.tag.del.end.confluence
    monospaced:
        name: markup.raw.confluence
        match: (\{{2})(.*?)(\}{2})
        captures:
            "1":
                name: meta.tag.code.begin.confluence
            "2":
                name: text.html.monospaced.element.confluence
            "3":
                name: meta.tag.code.end.confluence
uuid: 2D045A75-E4D7-4904-8766-D6234F10FCA1
